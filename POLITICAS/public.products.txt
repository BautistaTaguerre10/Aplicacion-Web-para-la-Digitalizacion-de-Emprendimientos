ALTER TABLE public.products ENABLE ROW LEVEL SECURITY;
-- opcional: forzar RLS
-- ALTER TABLE public.products FORCE ROW LEVEL SECURITY;
Luego, recreá las políticas que pusiste en tu JSON:

sql
Copiar código
-- DELETE: solo dueño
DROP POLICY IF EXISTS products_delete_owner_only ON public.products;
CREATE POLICY products_delete_owner_only
ON public.products
AS PERMISSIVE
FOR DELETE
TO public
USING (user_id = auth.uid());

-- INSERT: solo si user_id = auth.uid()
DROP POLICY IF EXISTS products_insert_owner_only ON public.products;
CREATE POLICY products_insert_owner_only
ON public.products
AS PERMISSIVE
FOR INSERT
TO public
WITH CHECK (user_id = auth.uid());

-- SELECT: públicos (visible=true) o dueño
DROP POLICY IF EXISTS products_select_public_or_owner ON public.products;
CREATE POLICY products_select_public_or_owner
ON public.products
AS PERMISSIVE
FOR SELECT
TO public
USING ((visible = true) OR (user_id = auth.uid()));

-- UPDATE: solo dueño
DROP POLICY IF EXISTS products_update_owner_only ON public.products;
CREATE POLICY products_update_owner_only
ON public.products
AS PERMISSIVE
FOR UPDATE
TO public
USING (user_id = auth.uid())
WITH CHECK (user_id = auth.uid());